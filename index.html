<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario WhatsApp - Reporte de Equipos</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        body {
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        body.dark-mode {
            background-color: #1a1a1a;
            color: #f0f0f0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
        }
        .dark-mode .container {
            background-color: #2d2d2d;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        header {
            background-color: #25D366;
            color: white;
            padding: 15px 20px;
            text-align: center;
            position: relative;
        }
        h1 {
            margin: 0;
            font-size: 1.5rem;
        }
        .author-credit {
            font-size: 0.8rem;
            opacity: 0.9;
            margin-top: 5px;
            font-style: italic;
        }
        .theme-toggle {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 20px;
            padding: 5px 10px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .form-container {
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .dark-mode label {
            color: #f0f0f0;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            background-color: white;
            color: #333;
        }
        .dark-mode input, .dark-mode select, .dark-mode textarea {
            background-color: #3d3d3d;
            border-color: #555;
            color: #f0f0f0;
        }
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        .list-input {
            display: flex;
            margin-bottom: 5px;
            position: relative;
        }
        .list-input input, .list-input select {
            flex-grow: 1;
            margin-right: 5px;
        }
        .add-btn {
            background-color: #25D366;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 0 15px;
            cursor: pointer;
            z-index: 2;
        }
        .list-items {
            margin-top: 10px;
        }
        .list-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            margin-bottom: 5px;
        }
        .dark-mode .list-item {
            background-color: #3d3d3d;
        }
        .remove-btn {
            background: none;
            border: none;
            color: #ff4444;
            cursor: pointer;
        }
        .conditional-section {
            display: none;
            margin-top: 10px;
        }
        .preview-container {
            margin-top: 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 10px;
        }
        .dark-mode .preview-container {
            background-color: #3d3d3d;
        }
        .preview-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #25D366;
        }
        .preview-content {
            white-space: pre-line;
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-family: monospace;
            max-height: 400px;
            overflow-y: auto;
        }
        .dark-mode .preview-content {
            background-color: #1a1a1a;
            border-color: #555;
            color: #f0f0f0;
        }
        .actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn-primary {
            background-color: #25D366;
            color: white;
        }
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        .btn:hover {
            opacity: 0.9;
        }
        .suggested-options {
            margin-top: 5px;
            font-size: 0.9rem;
            color: #666;
        }
        .dark-mode .suggested-options {
            color: #aaa;
        }
        
        /* Estilos para el autocompletado */
        .autocomplete-container {
            position: relative;
            width: 100%;
        }
        .autocomplete-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        .dark-mode .autocomplete-input {
            background-color: #3d3d3d;
            border-color: #555;
            color: #f0f0f0;
        }
        .autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 5px 5px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        .dark-mode .autocomplete-list {
            background: #3d3d3d;
            border-color: #555;
            color: #f0f0f0;
        }
        .autocomplete-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        .dark-mode .autocomplete-item {
            border-bottom: 1px solid #555;
        }
        .autocomplete-item:hover {
            background-color: #f0f0f0;
        }
        .dark-mode .autocomplete-item:hover {
            background-color: #4d4d4d;
        }
        .autocomplete-item:last-child {
            border-bottom: none;
        }
        .autocomplete-highlight {
            font-weight: bold;
            color: #25D366;
        }
        
        /* Estilos para el footer con cr√©ditos */
        .footer-credits {
            text-align: center;
            padding: 15px;
            margin-top: 20px;
            border-top: 1px solid #eee;
            font-size: 0.9rem;
            color: #666;
        }
        .dark-mode .footer-credits {
            border-top: 1px solid #555;
            color: #aaa;
        }
        .footer-credits a {
            color: #25D366;
            text-decoration: none;
        }
        .footer-credits a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Formulario de Reporte de Equipos</h1>
            <div class="author-credit">By j!mm</div>
            <button class="theme-toggle" id="themeToggle">
                <span id="themeIcon">üåô</span> <span id="themeText">Modo Oscuro</span>
            </button>
        </header>
        
        <div class="form-container">
            <form id="whatsappForm">
                <div class="form-group">
                    <label for="equipo">*EQUIPO:*</label>
                    <select id="equipo" required>
                        <option value="">Seleccione un equipo</option>
                        <option value="LT - 01">LT - 01</option>
                        <option value="TD - 01">TD - 01</option>
                        <option value="TD - 02">TD - 02</option>
                        <option value="TD - 03">TD - 03</option>
                        <option value="TD - 04">TD - 04</option>
                        <option value="TD - 05">TD - 05</option>
                        <option value="TD - 06">TD - 06</option>
                        <option value="TD - 11">TD - 11</option>
                        <option value="TD - 12">TD - 12</option>
                        <option value="TD - 13">TD - 13</option>
                        <option value="TL - 01">TL - 01</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="presenta">*PRESENTA:*</label>
                    <div class="autocomplete-container">
                        <input type="text" id="presenta" class="autocomplete-input" placeholder="Escriba o seleccione una opci√≥n" required>
                        <div class="autocomplete-list" id="presentaAutocomplete"></div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="turno">*TURNO:*</label>
                    <select id="turno" required>
                        <option value="">Seleccione un turno</option>
                        <option value="DIA">DIA</option>
                        <option value="NOCHE">NOCHE</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="fecha">*FECHA:*</label>
                    <input type="date" id="fecha" required>
                </div>
                
                <div class="form-group">
                    <label for="horaInicio">*HORA INICIO:*</label>
                    <input type="time" id="horaInicio" required>
                </div>
                
                <div class="form-group">
                    <label for="horaFin">*HORA FIN:*</label>
                    <input type="time" id="horaFin" required>
                </div>
                
                <div class="form-group">
                    <label for="horometro">*HOROMETRO:*</label>
                    <input type="number" id="horometro" placeholder="Ingrese el hor√≥metro" required>
                </div>
                
                <div class="form-group">
                    <label for="supervisor">*SUPERVISOR:*</label>
                    <select id="supervisor" required>
                        <option value="">Seleccione un supervisor</option>
                        <option value="Abimael Flores">Abimael Flores</option>
                        <option value="Otro">Otro</option>
                    </select>
                    <input type="text" id="supervisorOtro" placeholder="Ingrese otro supervisor" style="display: none; margin-top: 5px;">
                </div>
                
                <div class="form-group">
                    <label>*TECNICOS:*</label>
                    <div class="list-input">
                        <input type="text" id="tecnicoInput" placeholder="Ingrese nombre del t√©cnico">
                        <button type="button" class="add-btn" id="addTecnico">+</button>
                    </div>
                    <div class="list-items" id="tecnicosList"></div>
                </div>
                
                <div class="form-group">
                    <label>*TRABAJOS REALIZADOS:*</label>
                    <div class="list-input">
                        <div class="autocomplete-container">
                            <input type="text" id="trabajoInput" class="autocomplete-input" placeholder="Escriba o seleccione un trabajo">
                            <div class="autocomplete-list" id="trabajoAutocomplete"></div>
                        </div>
                        <button type="button" class="add-btn" id="addTrabajo">+</button>
                    </div>
                    <div class="list-items" id="trabajosList"></div>
                </div>
                
                <div class="form-group">
                    <label for="aprovechamiento">*APROVECHAMIENTO:*</label>
                    <select id="aprovechamiento">
                        <option value="">Seleccione</option>
                        <option value="SI">SI</option>
                        <option value="NO">NO</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="demoras">*DEMORAS:*</label>
                    <select id="demoras">
                        <option value="">Seleccione</option>
                        <option value="SI">SI</option>
                        <option value="NO">NO</option>
                    </select>
                    <div class="conditional-section" id="demorasSection">
                        <div class="list-input">
                            <input type="text" id="demoraInput" placeholder="Ingrese demora">
                            <button type="button" class="add-btn" id="addDemora">+</button>
                        </div>
                        <div class="list-items" id="demorasList"></div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="observaciones">*OBSERVACIONES:*</label>
                    <select id="observaciones">
                        <option value="">Seleccione</option>
                        <option value="SI">SI</option>
                        <option value="NO">NO</option>
                    </select>
                    <div class="conditional-section" id="observacionesSection">
                        <div class="list-input">
                            <input type="text" id="observacionInput" placeholder="Ingrese observaci√≥n">
                            <button type="button" class="add-btn" id="addObservacion">+</button>
                        </div>
                        <div class="list-items" id="observacionesList"></div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="relevo">*RELEVO:*</label>
                    <select id="relevo">
                        <option value="">Seleccione</option>
                        <option value="SI">SI</option>
                        <option value="NO">NO</option>
                    </select>
                    <div class="conditional-section" id="relevoSection">
                        <div class="list-input">
                            <input type="text" id="relevoInput" placeholder="Ingrese relevo">
                            <button type="button" class="add-btn" id="addRelevo">+</button>
                        </div>
                        <div class="list-items" id="relevoList"></div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="equipoOperativo">*EQUIPO OPERATIVO:*</label>
                    <select id="equipoOperativo" required>
                        <option value="">Seleccione</option>
                        <option value="SI">SI</option>
                        <option value="NO">NO</option>
                    </select>
                </div>
            </form>
            
            <div class="preview-container">
                <div class="preview-title">Vista Previa del Mensaje:</div>
                <div class="preview-content" id="preview"></div>
            </div>
            
            <div class="actions">
                <button type="button" class="btn btn-secondary" id="clearForm">Limpiar Formulario</button>
                <button type="button" class="btn btn-primary" id="generateWhatsApp">Generar WhatsApp</button>
            </div>
            
            <!-- Footer con cr√©ditos -->
            <div class="footer-credits">
                By <strong>j!mm</strong> | 
                <a href="https://github.com/tuusuario/turepositorio" target="_blank">Ver c√≥digo en GitHub</a>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Establecer fecha actual por defecto
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('fecha').value = formattedDate;
            
            // Arrays para almacenar elementos de lista
            const tecnicos = [];
            const trabajos = [];
            const demoras = [];
            const observaciones = [];
            const relevos = [];
            
            // Lista de trabajos sugeridos
            const trabajosSugeridos = [
                "Inspecci√≥n de niveles de fluidos.",
                "Inspecci√≥n de nivel de refrigerante.",
                "Inspecci√≥n de nivel de aceite de compresor.",
                "Inspecci√≥n de nivel de aceite hidr√°ulico.",
                "Inspecci√≥n de nivel de aceite de PTO.",
                "Inspecci√≥n de nivel de aceite de motor.",
                "Inspecci√≥n de nivel de aceite de bomba de agua.",
                "Se rellena dep√≥sitos de lubricaci√≥n de pistones de bomba de agua.",
                "Inspecci√≥n de broca.",
                "Inspecci√≥n de carrileria LC y LNC.",
                "Se realiza inspecci√≥n y limpieza de sensores de gatos de nivelaci√≥n.",
                "Se realiza limpieza de sensores ODS.",
                "Limpieza de plataforma de perforaci√≥n."
            ];
            
            // Lista de opciones para PRESENTA
            const presentaOpciones = [
                "Inspecci√≥n de equipo",
                "Mantenimiento programado"
            ];
            
            // Referencias a elementos del DOM
            const tecnicoInput = document.getElementById('tecnicoInput');
            const trabajoInput = document.getElementById('trabajoInput');
            const trabajoAutocomplete = document.getElementById('trabajoAutocomplete');
            const presentaInput = document.getElementById('presenta');
            const presentaAutocomplete = document.getElementById('presentaAutocomplete');
            const demoraInput = document.getElementById('demoraInput');
            const observacionInput = document.getElementById('observacionInput');
            const relevoInput = document.getElementById('relevoInput');
            
            const tecnicosList = document.getElementById('tecnicosList');
            const trabajosList = document.getElementById('trabajosList');
            const demorasList = document.getElementById('demorasList');
            const observacionesList = document.getElementById('observacionesList');
            const relevoList = document.getElementById('relevoList');
            
            // Funci√≥n para capitalizar solo la primera letra de la primera palabra
            function capitalizarPrimeraPalabra(texto) {
                if (!texto) return texto;
                return texto.charAt(0).toUpperCase() + texto.slice(1).toLowerCase();
            }
            
            // Funci√≥n para capitalizar nombres de personas (primera letra de cada palabra)
            function capitalizarNombre(texto) {
                return texto.replace(/\b\w/g, function(l) { 
                    return l.toUpperCase(); 
                });
            }
            
            // Funci√≥n para capitalizar texto al perder el foco
            function capitalizarAlPerderFoco(input, esNombrePersona = false) {
                input.addEventListener('blur', function() {
                    if (this.value) {
                        if (esNombrePersona) {
                            this.value = capitalizarNombre(this.value);
                        } else {
                            this.value = capitalizarPrimeraPalabra(this.value);
                        }
                        updatePreview();
                    }
                });
            }
            
            // Aplicar capitalizaci√≥n a los campos de texto
            capitalizarAlPerderFoco(tecnicoInput, true); // Para nombres de personas
            capitalizarAlPerderFoco(demoraInput);
            capitalizarAlPerderFoco(observacionInput);
            capitalizarAlPerderFoco(relevoInput);
            capitalizarAlPerderFoco(document.getElementById('supervisorOtro'));
            
            // Sistema de autocompletado para PRESENTA
            presentaInput.addEventListener('input', function() {
                const value = this.value.toLowerCase();
                if (value.length > 0) {
                    const filtered = presentaOpciones.filter(opcion => 
                        opcion.toLowerCase().includes(value)
                    );
                    showPresentaAutocomplete(filtered, value);
                } else {
                    hidePresentaAutocomplete();
                }
            });
            
            presentaInput.addEventListener('focus', function() {
                const value = this.value.toLowerCase();
                if (value.length > 0) {
                    const filtered = presentaOpciones.filter(opcion => 
                        opcion.toLowerCase().includes(value)
                    );
                    showPresentaAutocomplete(filtered, value);
                } else {
                    showPresentaAutocomplete(presentaOpciones, '');
                }
            });
            
            // Funci√≥n para mostrar sugerencias de autocompletado para PRESENTA
            function showPresentaAutocomplete(suggestions, searchTerm) {
                presentaAutocomplete.innerHTML = '';
                
                if (suggestions.length === 0) {
                    hidePresentaAutocomplete();
                    return;
                }
                
                suggestions.forEach(suggestion => {
                    const item = document.createElement('div');
                    item.className = 'autocomplete-item';
                    
                    // Resaltar el texto coincidente
                    let displayText = suggestion;
                    if (searchTerm) {
                        const regex = new RegExp(`(${searchTerm})`, 'gi');
                        displayText = suggestion.replace(regex, '<span class="autocomplete-highlight">$1</span>');
                    }
                    
                    item.innerHTML = displayText;
                    
                    item.addEventListener('click', function() {
                        presentaInput.value = suggestion;
                        hidePresentaAutocomplete();
                        updatePreview();
                    });
                    
                    presentaAutocomplete.appendChild(item);
                });
                
                presentaAutocomplete.style.display = 'block';
            }
            
            // Funci√≥n para ocultar el autocompletado de PRESENTA
            function hidePresentaAutocomplete() {
                presentaAutocomplete.style.display = 'none';
            }
            
            // Ocultar autocompletado de PRESENTA al hacer clic fuera
            document.addEventListener('click', function(e) {
                if (!presentaInput.contains(e.target) && !presentaAutocomplete.contains(e.target)) {
                    hidePresentaAutocomplete();
                }
            });
            
            // Manejar selecci√≥n de supervisor
            document.getElementById('supervisor').addEventListener('change', function() {
                const otroInput = document.getElementById('supervisorOtro');
                if (this.value === 'Otro') {
                    otroInput.style.display = 'block';
                    otroInput.required = true;
                } else {
                    otroInput.style.display = 'none';
                    otroInput.required = false;
                }
                updatePreview();
            });
            
            // Sistema de autocompletado para trabajos
            trabajoInput.addEventListener('input', function() {
                const value = this.value.toLowerCase();
                if (value.length > 0) {
                    const filtered = trabajosSugeridos.filter(trabajo => 
                        trabajo.toLowerCase().includes(value)
                    );
                    showAutocomplete(filtered, value);
                } else {
                    hideAutocomplete();
                }
            });
            
            trabajoInput.addEventListener('focus', function() {
                const value = this.value.toLowerCase();
                if (value.length > 0) {
                    const filtered = trabajosSugeridos.filter(trabajo => 
                        trabajo.toLowerCase().includes(value)
                    );
                    showAutocomplete(filtered, value);
                } else {
                    showAutocomplete(trabajosSugeridos, '');
                }
            });
            
            // Funci√≥n para mostrar sugerencias de autocompletado para TRABAJOS
            function showAutocomplete(suggestions, searchTerm) {
                trabajoAutocomplete.innerHTML = '';
                
                if (suggestions.length === 0) {
                    hideAutocomplete();
                    return;
                }
                
                suggestions.forEach(suggestion => {
                    const item = document.createElement('div');
                    item.className = 'autocomplete-item';
                    
                    // Resaltar el texto coincidente
                    let displayText = suggestion;
                    if (searchTerm) {
                        const regex = new RegExp(`(${searchTerm})`, 'gi');
                        displayText = suggestion.replace(regex, '<span class="autocomplete-highlight">$1</span>');
                    }
                    
                    item.innerHTML = displayText;
                    
                    item.addEventListener('click', function() {
                        trabajoInput.value = suggestion;
                        hideAutocomplete();
                    });
                    
                    trabajoAutocomplete.appendChild(item);
                });
                
                trabajoAutocomplete.style.display = 'block';
            }
            
            // Funci√≥n para ocultar el autocompletado de TRABAJOS
            function hideAutocomplete() {
                trabajoAutocomplete.style.display = 'none';
            }
            
            // Ocultar autocompletado de TRABAJOS al hacer clic fuera
            document.addEventListener('click', function(e) {
                if (!trabajoInput.contains(e.target) && !trabajoAutocomplete.contains(e.target)) {
                    hideAutocomplete();
                }
            });
            
            // Funciones para agregar elementos a las listas
            document.getElementById('addTecnico').addEventListener('click', function() {
                const value = tecnicoInput.value.trim();
                if (value) {
                    tecnicos.push(capitalizarNombre(value)); // Capitalizar nombres de personas
                    updateListDisplay(tecnicos, tecnicosList);
                    tecnicoInput.value = '';
                    updatePreview();
                }
            });
            
            document.getElementById('addTrabajo').addEventListener('click', function() {
                const value = trabajoInput.value.trim();
                if (value) {
                    trabajos.push(capitalizarPrimeraPalabra(value)); // Solo primera palabra en may√∫scula
                    updateListDisplay(trabajos, trabajosList);
                    trabajoInput.value = '';
                    hideAutocomplete();
                    updatePreview();
                }
            });
            
            document.getElementById('addDemora').addEventListener('click', function() {
                const value = demoraInput.value.trim();
                if (value) {
                    demoras.push(capitalizarPrimeraPalabra(value)); // Solo primera palabra en may√∫scula
                    updateListDisplay(demoras, demorasList);
                    demoraInput.value = '';
                    updatePreview();
                }
            });
            
            document.getElementById('addObservacion').addEventListener('click', function() {
                const value = observacionInput.value.trim();
                if (value) {
                    observaciones.push(capitalizarPrimeraPalabra(value)); // Solo primera palabra en may√∫scula
                    updateListDisplay(observaciones, observacionesList);
                    observacionInput.value = '';
                    updatePreview();
                }
            });
            
            document.getElementById('addRelevo').addEventListener('click', function() {
                const value = relevoInput.value.trim();
                if (value) {
                    relevos.push(capitalizarPrimeraPalabra(value)); // Solo primera palabra en may√∫scula
                    updateListDisplay(relevos, relevoList);
                    relevoInput.value = '';
                    updatePreview();
                }
            });
            
            // Funci√≥n para actualizar la visualizaci√≥n de listas
            function updateListDisplay(array, listElement) {
                listElement.innerHTML = '';
                array.forEach((item, index) => {
                    const listItem = document.createElement('div');
                    listItem.className = 'list-item';
                    listItem.innerHTML = `
                        <span>- ${item}</span>
                        <button type="button" class="remove-btn" data-index="${index}">‚úï</button>
                    `;
                    listElement.appendChild(listItem);
                });
                
                // Agregar event listeners a los botones de eliminar
                listElement.querySelectorAll('.remove-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        array.splice(index, 1);
                        updateListDisplay(array, listElement);
                        updatePreview();
                    });
                });
            }
            
            // Mostrar/ocultar secciones condicionales
            document.getElementById('demoras').addEventListener('change', function() {
                document.getElementById('demorasSection').style.display = 
                    this.value === 'SI' ? 'block' : 'none';
                updatePreview();
            });
            
            document.getElementById('observaciones').addEventListener('change', function() {
                document.getElementById('observacionesSection').style.display = 
                    this.value === 'SI' ? 'block' : 'none';
                updatePreview();
            });
            
            document.getElementById('relevo').addEventListener('change', function() {
                document.getElementById('relevoSection').style.display = 
                    this.value === 'SI' ? 'block' : 'none';
                updatePreview();
            });
            
            // Actualizar vista previa cuando cambien los campos
            const formElements = document.querySelectorAll('#whatsappForm input, #whatsappForm select, #whatsappForm textarea');
            formElements.forEach(element => {
                element.addEventListener('input', updatePreview);
                element.addEventListener('change', updatePreview);
            });
            
            // Funci√≥n para actualizar la vista previa
            function updatePreview() {
                const equipo = document.getElementById('equipo').value;
                const presenta = document.getElementById('presenta').value;
                const turno = document.getElementById('turno').value;
                const fecha = document.getElementById('fecha').value;
                const horaInicio = document.getElementById('horaInicio').value;
                const horaFin = document.getElementById('horaFin').value;
                const horometro = document.getElementById('horometro').value;
                
                let supervisor = document.getElementById('supervisor').value;
                if (supervisor === 'Otro') {
                    supervisor = document.getElementById('supervisorOtro').value;
                }
                
                const aprovechamiento = document.getElementById('aprovechamiento').value;
                const demoras = document.getElementById('demoras').value;
                const observaciones = document.getElementById('observaciones').value;
                const relevo = document.getElementById('relevo').value;
                const equipoOperativo = document.getElementById('equipoOperativo').value;
                
                // Formatear fecha
                const fechaObj = new Date(fecha);
                const formattedFecha = fechaObj.toLocaleDateString('es-ES');
                
                let previewText = '';
                
                previewText += `*EQUIPO:* ${equipo}\n`;
                previewText += `*PRESENTA:* ${presenta}\n`;
                previewText += `*TURNO:* ${turno}\n`;
                previewText += `*FECHA:* ${formattedFecha}\n`;
                previewText += `*HORA INICIO:* ${horaInicio}\n`;
                previewText += `*HORA FIN:* ${horaFin}\n`;
                previewText += `*HOROMETRO:* ${horometro}\n`;
                previewText += `*SUPERVISOR:* ${supervisor}\n`;
                
                previewText += `*TECNICOS:*\n`;
                if (tecnicos.length > 0) {
                    tecnicos.forEach(tecnico => {
                        previewText += `- ${tecnico}\n`;
                    });
                } else {
                    previewText += `- \n`;
                }
                
                previewText += `*TRABAJOS REALIZADOS:*\n`;
                if (trabajos.length > 0) {
                    trabajos.forEach(trabajo => {
                        previewText += `- ${trabajo}\n`;
                    });
                } else {
                    previewText += `- \n`;
                }
                
                previewText += `*APROVECHAMIENTO:* ${aprovechamiento}\n`;
                
                previewText += `*DEMORAS:* ${demoras}\n`;
                if (demoras === 'SI' && demorasList.querySelectorAll('.list-item').length > 0) {
                    document.querySelectorAll('#demorasList .list-item span').forEach(item => {
                        previewText += `${item.textContent}\n`;
                    });
                }
                
                previewText += `*OBSERVACIONES:* ${observaciones}\n`;
                if (observaciones === 'SI' && observacionesList.querySelectorAll('.list-item').length > 0) {
                    document.querySelectorAll('#observacionesList .list-item span').forEach(item => {
                        previewText += `${item.textContent}\n`;
                    });
                }
                
                previewText += `*RELEVO:* ${relevo}\n`;
                if (relevo === 'SI' && relevoList.querySelectorAll('.list-item').length > 0) {
                    document.querySelectorAll('#relevoList .list-item span').forEach(item => {
                        previewText += `${item.textContent}\n`;
                    });
                }
                
                previewText += `*EQUIPO OPERATIVO:* ${equipoOperativo}`;
                
                document.getElementById('preview').textContent = previewText;
            }
            
            // Generar enlace de WhatsApp
            document.getElementById('generateWhatsApp').addEventListener('click', function() {
                const previewText = document.getElementById('preview').textContent;
                const encodedText = encodeURIComponent(previewText);
                const whatsappUrl = `https://wa.me/?text=${encodedText}`;
                window.open(whatsappUrl, '_blank');
            });
            
            // Limpiar formulario
            document.getElementById('clearForm').addEventListener('click', function() {
                document.getElementById('whatsappForm').reset();
                
                // Limpiar arrays y listas
                tecnicos.length = 0;
                trabajos.length = 0;
                demoras.length = 0;
                observaciones.length = 0;
                relevos.length = 0;
                
                tecnicosList.innerHTML = '';
                trabajosList.innerHTML = '';
                demorasList.innerHTML = '';
                observacionesList.innerHTML = '';
                relevoList.innerHTML = '';
                
                // Ocultar secciones condicionales
                document.getElementById('demorasSection').style.display = 'none';
                document.getElementById('observacionesSection').style.display = 'none';
                document.getElementById('relevoSection').style.display = 'none';
                
                // Ocultar campos "Otro"
                document.getElementById('supervisorOtro').style.display = 'none';
                
                // Ocultar autocompletados
                hidePresentaAutocomplete();
                hideAutocomplete();
                
                // Restablecer fecha actual
                document.getElementById('fecha').value = formattedDate;
                
                updatePreview();
            });
            
            // Toggle de modo oscuro/claro
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.getElementById('themeText');
            
            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                
                if (document.body.classList.contains('dark-mode')) {
                    themeIcon.textContent = '‚òÄÔ∏è';
                    themeText.textContent = 'Modo Claro';
                } else {
                    themeIcon.textContent = 'üåô';
                    themeText.textContent = 'Modo Oscuro';
                }
            });
            
            // Inicializar vista previa
            updatePreview();
        });
    </script>
</body>
</html>
